(()=>{"use strict";var t,e,s,r,i,n,o={71447:(t,e,s)=>{s.a(t,(async(t,e)=>{try{var r=s(97039),i=s(66421);const t=await(0,r.Y)();i.h.init(t),i.h.start(),e()}catch(t){e(t)}}),1)},99673:(t,e,s)=>{s.d(e,{Az:()=>r.Az});var r=s(33410);s(93587)},28432:(t,e,s)=>{s.d(e,{j:()=>o});var r=s(87137),i=s(84918),n=s(55725);class o{name;index;threadPoolName;static readySet=new Set;get isRemoteReady(){return o.readySet.has(this)}get isPortSet(){return Boolean(this.port)}port=null;_pool=null;constructor(t,e,s="worker",r=null){this.name=t,this.index=e,this.threadPoolName=s,this._pool=r}setPort(t){if(this.port=t,"browser"==r.Q.environment){const e=t;e.onmessage=t=>{if(n.E.isInternal(t.data))return n.E.runInternal(t.data,this,t)},e.onmessageerror=t=>{console.error(`Error occured in from thread ${this.name}`),console.log(t.data),console.log(t)}}if("node"==r.Q.environment){const e=t;e.on("message",(t=>{if(n.E.isInternal(t))return n.E.runInternal(t,this,t)})),e.on("error",(t=>{console.error(`Error occured in from thread ${this.name}`),console.log(t)}))}this.sendMessage([n.E.INTERNAL_CODE,i.g.setReady,[this.name,this.index]])}sendMessage(t,e){if(!this.port)throw new Error(`Cannot send message to thread [${this.name}] port is not set`);this.port.postMessage(t,"browser"==r.Q.environment&&e?e:void 0)}connectToThread(t){const e=new MessageChannel;t.sendMessage([n.E.INTERNAL_CODE,i.g.connectPort,[this.name,this.threadPoolName,e.port1]],[e.port1]),this.sendMessage([n.E.INTERNAL_CODE,i.g.connectPort,[t.name,t.threadPoolName,e.port2]],[e.port2])}waitTillTaskExist(t,e=50){let s=!1;return new Promise((r=>{const i=t=>{if(s)return clearTimeout(o);t?(s=!0,r(!0),clearTimeout(o)):setTimeout(n,e)},n=()=>{this.taskExist(t,i)};let o=setTimeout(n,e)}))}taskExist(t,e){const s=n.E.getPromiseId();n.z.checkTasks[2][0]=t,n.z.checkTasks[2][1]=s,this.sendMessage(n.z.checkTasks),n.E.addPromiseTakss("tasks-check",s,(t=>{e(t)}))}runTask(t,e,s,r){const i=r?n.E.getPromiseId():-1;r&&n.E.addPromiseTakss(t,i,r),n.z.runTask[2][0]=t,n.z.runTask[2][1]=i,n.z.runTask[2][2]=e,this.sendMessage(n.z.runTask,s),n.z.runTask[2][2]=null}runTaskAsync(t,e,s){return new Promise((r=>{this.runTask(t,e,s,(t=>{r(t)}))}))}waitTillReady(){return new Promise(((t,e)=>{const s=setInterval((()=>{this.isPortSet&&(clearInterval(s),t(!0))}),1)}))}destroy(){o.readySet.delete(this),this.port&&"terminate"in this.port&&this.port.terminate()}}},82938:(t,e,s)=>{s.d(e,{p:()=>n});var r=s(28432),i=s(87137);class n{name;_totalThreads=0;_currentThread=0;__threads=[];constructor(t){this.name=t}getThreads(){return this.__threads}connectToThread(t){for(const e of this.__threads)e.connectToThread(t)}destroyAll(){for(const t of this.__threads)t.destroy()}isReady(){let t=!0;for(const e of this.__threads)e.isPortSet||(t=!1);return t}waitTillAllAreReady(){return new Promise(((t,e)=>{const s=setInterval((()=>{this.isReady()&&(clearInterval(s),t(!0))}),1)}))}addPort(t){const e=`${this.name}-${this._totalThreads}`,s=new r.j(e,this._totalThreads,this.name,this);i.Q.addThread(s),s.setPort(t),this.__threads.push(s),this._totalThreads++}runTaskForAll(t,e,s){for(let r=0;r<this.__threads.length;r++)this.__threads[r].runTask(t,e,s)}runTask(t,e,s,r,i,n){return"number"!=typeof i?(this._currentThread==n&&this.__handleCount(),this.__threads[this._currentThread].runTask(t,e,s,r),this.__handleCount()):(this.__threads[i].runTask(t,e,s,r),i)}runTaskAsync(t,e,s,r,i){return new Promise((n=>{this.runTask(t,e,s,n,r,i)}))}__handleCount(){let t=this._currentThread;return this._currentThread++,this._currentThread>=this._totalThreads&&(this._currentThread=0),t}}},66421:(t,e,s)=>{s.d(e,{h:()=>O});var r=s(24579);const i=r.$m.registerContext({type:"dve-nexus"});var n=s(99673);const o=r.$m.registerComponent({type:"transform",schema:r.$m.schema({position:r.$m.property(n.Az.Create(),{type:"vector-3",binary:"f32"}),rotation:r.$m.property(n.Az.Create(),{type:"vector-3",binary:"f32"}),scale:r.$m.property(n.Az.Create(1,1,1),{type:"vector-3",binary:"f32"})},[{id:"shared-array",type:"typed-array",sharedMemory:!0,arrayType:"f32"},{id:"array",type:"typed-array",arrayType:"f32"}])}),a=r.$m.registerComponent({type:"box-collider",schema:r.$m.schema({offset:r.$m.property(n.Az.Create(),{type:"vector-3",binary:"f32"}),size:r.$m.property(n.Az.Create(),{type:"vector-3",binary:"f32"})},[{id:"shared-binary-object",type:"binary-object",sharedMemory:!0},{id:"shared-binary-object",type:"binary-object"}])});class h{component;constructor(t){this.component=t}setForce(t){return n.Az.Copy(this.component.schema.force,t),t}getForce(){return this.component.schema.force}setVelocity(t){return n.Az.Copy(this.component.schema.velocity,t),t}getVelocity(){return this.component.schema.velocity}}const d=r.$m.registerComponent({type:"physics-body",data:r.$m.data(),schema:r.$m.schema({velocity:r.$m.property(n.Az.Create(),{binary:"f32"}),mass:r.$m.property(1,{binary:"f32"}),friction:r.$m.property(.5,{binary:"f32"}),acceleration:r.$m.property(n.Az.Create(),{binary:"f32"}),angularVelocity:r.$m.property(n.Az.Create(),{binary:"f32"}),angularAcceleration:r.$m.property(n.Az.Create(),{binary:"f32"}),force:r.$m.property(n.Az.Create(),{binary:"f32"}),torque:r.$m.property(n.Az.Create(),{binary:"f32"}),damping:r.$m.property(n.Az.Create(),{binary:"f32"}),angularDamping:r.$m.property(.1,{binary:"f32"}),gravityScale:r.$m.property(1,{binary:"f32"}),isKinematic:r.$m.property(0,{binary:"ui8"})},[{id:"shared-binary-object",type:"binary-object",sharedMemory:!0},{id:"binary-object",type:"binary-object"}]),init:t=>t.data=new h(t.cloneCursor()),dispose:t=>t.data.component.returnCursor()});class l{raw={hitDepth:1,nx:0,ny:0,nz:0};update(t,e,s,r){return this.raw.hitDepth=t,this.raw.nx=e,this.raw.ny=s,this.raw.nz=r,this}loadIn(t){this.raw.hitDepth=t.raw.hitDepth,this.raw.nx=t.raw.nx,this.raw.ny=t.raw.ny,this.raw.nz=t.raw.nz}reset(){this.raw.hitDepth=1,this.raw.nx=0,this.raw.ny=0,this.raw.nz=0}collided(){return this.raw.hitDepth<1}faceHit={top:()=>1==this.raw.ny&&this.collided(),bottom:()=>-1==this.raw.ny&&this.collided(),east:()=>1==this.raw.nx&&this.collided(),west:()=>-1==this.raw.nx&&this.collided(),north:()=>1==this.raw.nz&&this.collided(),south:()=>-1==this.raw.nz&&this.collided()};normalHit={x:()=>this.raw.nx,y:()=>this.raw.ny,z:()=>this.raw.nz}}class c{bounds={minX:1/0,maxX:-1/0,minZ:1/0,maxZ:-1/0,minY:1/0,maxY:-1/0};_full={w:.8,h:1.8,d:.8};_half={w:.4,h:.9,d:.4};position=n.Az.Create();constructor(t=1,e=t,s=t){this._full.w=t,this._full.h=e,this._full.d=s,this._half.w=t/2,this._half.h=e/2,this._half.d=s/2}update(t,e,s){this.width=t,this.height=e,this.depth=s}setPosition(t){n.Az.Copy(this.position,t);const e=this.position;this.bounds.minX=e.x,this.bounds.maxX=e.x+this.width,this.bounds.minZ=e.z,this.bounds.maxZ=e.z+this.depth,this.bounds.minY=e.y,this.bounds.maxY=e.y+this.height}get width(){return this._full.w}get height(){return this._full.h}get depth(){return this._full.d}set width(t){this._full.w=t,this._half.w=t/2}set height(t){this._full.h=t,this._half.h=t/2}set depth(t){this._full.d=t,this._half.d=t/2}get halfWidth(){return this._half.w}get halfHeight(){return this._half.h}get halfDepth(){return this._half.d}pointIsInside(t){return t.x>=this.bounds.minX&&t.x<=this.bounds.maxX&&t.y>=this.bounds.minY&&t.y<=this.bounds.maxY&&t.z>=this.bounds.minZ&&t.z<=this.bounds.maxZ}doesIntersect(t){return this.bounds.minX<=t.bounds.maxX&&this.bounds.maxX>=t.bounds.minX&&this.bounds.minY<=t.bounds.maxY&&this.bounds.maxY>=t.bounds.minY&&this.bounds.minZ<=t.bounds.maxZ&&this.bounds.maxZ>=t.bounds.minZ}*query(){const t=Math.floor(this.bounds.minX),e=Math.floor(this.bounds.minY),s=Math.floor(this.bounds.minZ),r=Math.ceil(this.bounds.maxX),i=Math.ceil(this.bounds.maxY),n=Math.ceil(this.bounds.maxZ);for(let o=e;o<=i;o++)for(let e=t;e<=r;e++)for(let t=s;t<=n;t++)yield[e,o,t]}}const u=r.$m.registerComponent({type:"collider-state",schema:r.$m.schema({isGrounded:r.$m.property(0,{binary:"ui8"}),isInLiquid:r.$m.property(0,{binary:"ui8"})},[{id:"shared-binary-object",type:"binary-object",sharedMemory:!0},{id:"binary-object",type:"binary-object"}])});var y=s(69224),p=s(62312);let m=[];const f=n.Az.Create();class x{sectorCursors=new Map;origin={x:0,y:0,z:0};dimension="";setFocalPoint(t,e,s,r){const i=p.k.sector.getPosition(e,s,r,f);for(const[t,e]of this.sectorCursors)for(const[t,s]of e)m.push(s);this.sectorCursors.clear(),this.dimension=t,this.origin.x=i.x/p.k.sector.bounds.x,this.origin.y=i.y/p.k.sector.bounds.y,this.origin.z=i.z/p.k.sector.bounds.z}inBounds(t,e,s){return p.k.world.inBounds(t,e,s)}getSector(t,e,s){if(!this.inBounds(t,e,s))return null;const r=p.k.sector.getPosition(t,e,s,f),i=r.x/p.k.sector.bounds.x-this.origin.x,n=r.z/p.k.sector.bounds.z-this.origin.z;let o=this.sectorCursors.get(i),a=o?.get(n);if(!a){if(a=m.length?m.shift():new y.j,!a.setSector(this.dimension,r.x,r.y,r.z))return m.push(a),null;o||(o=new Map,this.sectorCursors.set(i,o)),o.set(n,a)}return a}getVoxel(t,e,s){const r=this.getSector(t,e,s);return r?r.getVoxel(t,e,s):null}}const g={colliders:{},registerCollider(t){if(Array.isArray(t))return t.forEach((t=>this.colliders[t.id]=t));this.colliders[t.id]=t},getCollider(t){const e=this.colliders[t];if(!e)throw new Error(`Collider with ${t} does not exists.`);return e}},z=n.Az.Create(),b=n.Az.Create(),w=n.Az.Create(),v=n.Az.Create(),C=.001,_={results:new l,line:new class{start=n.Az.Create();end=n.Az.Create();update(t,e){return n.Az.Copy(this.start,t),n.Az.Copy(this.end,e),this}},plane:new class{dimensions=n.Az.Create();normal=n.Az.Create();update(t,e){return n.Az.Copy(this.dimensions,t),n.Az.Copy(this.normal,e),this}lineToPlane(t){const e=this.normal.x*t.end.x+this.normal.y*t.end.y+this.normal.z*t.end.z;return 0==e?1/0:(this.normal.x*(this.dimensions.x-t.start.x)+this.normal.y*(this.dimensions.y-t.start.y)+this.normal.z*(this.dimensions.z-t.start.z))/e}},dimensions:n.Az.Create()},T=new c,A=(t,e,s)=>t>=e&&t<=s,k={Zero:n.Az.Create(),Up:n.Az.Create(0,1,0),Down:n.Az.Create(0,-1,0),West:n.Az.Create(-1,0,0),East:n.Az.Create(1,0,0),North:n.Az.Create(0,0,1),South:n.Az.Create(0,0,-1)},P=(t,e,s,r)=>{let i,n,o,a,h,d,l;i=s.position.x-(t.x+e.width),n=s.position.y-(t.y+e.height),o=s.position.z-(t.z+e.depth),a=e.width+s.boundingBox.width,h=e.height+s.boundingBox.height,d=e.depth+s.boundingBox.depth,s.results.reset();const c=s.results.raw;return _.line.update(k.Zero,r),_.dimensions.x=i,_.dimensions.y=n,_.dimensions.z=o,l=_.plane.update(_.dimensions,k.West).lineToPlane(_.line),l>=0&&r.x>0&&l<c.hitDepth&&A(l*r.y,n,n+h)&&A(l*r.z,o,o+d)&&s.results.update(l,-1,0,0),_.dimensions.x=i+a,_.dimensions.y=n,_.dimensions.z=o,l=_.plane.update(_.dimensions,k.East).lineToPlane(_.line),l>=0&&r.x<0&&l<c.hitDepth&&A(l*r.y,n,n+h)&&A(l*r.z,o,o+d)&&s.results.update(l,1,0,0),_.dimensions.x=i,_.dimensions.y=n,_.dimensions.z=o,l=_.plane.update(_.dimensions,k.Down).lineToPlane(_.line),l>=0&&r.y>0&&l<c.hitDepth&&A(l*r.x,i,i+a)&&A(l*r.z,o,o+d)&&s.results.update(l,0,-1,0),_.dimensions.x=i,_.dimensions.y=n+h,_.dimensions.z=o,l=_.plane.update(_.dimensions,k.Up).lineToPlane(_.line),l>=0&&r.y<0&&l<c.hitDepth&&A(l*r.x,i,i+a)&&A(l*r.z,o,o+d)&&s.results.update(l,0,1,0),_.dimensions.x=i,_.dimensions.y=n,_.dimensions.z=o,l=_.plane.update(_.dimensions,k.South).lineToPlane(_.line),l>=0&&r.z>0&&l<c.hitDepth&&A(l*r.x,i,i+a)&&A(l*r.y,n,n+h)&&s.results.update(l,0,0,-1),_.dimensions.x=i,_.dimensions.y=n,_.dimensions.z=o+d,l=_.plane.update(_.dimensions,k.South).lineToPlane(_.line),l>=0&&r.z<0&&l<c.hitDepth&&A(l*r.x,i,i+a)&&A(l*r.y,n,n+h)&&s.results.update(l,0,0,1),s.results.raw};let M;n.Az.Create();const S=n.Az.Create();function $(t,e,s){if(e.isKinematic)return;e.force.y+=-9.81*e.mass*e.gravityScale;const r=e.force.x/e.mass,i=e.force.y/e.mass,n=e.force.z/e.mass;e.velocity.x+=r*s,e.velocity.y+=i*s,e.velocity.z+=n*s,e.velocity.y<-50&&(e.velocity.y=-50),e.velocity.x*=1-e.damping.x*s,e.velocity.y*=1-e.damping.y*s,e.velocity.z*=1-e.damping.z*s,S.x=-e.friction*e.velocity.x,S.y=-e.friction*e.velocity.y,S.z=-e.friction*e.velocity.z,e.velocity.x+=S.x*s,e.velocity.y+=S.y*s,e.velocity.z+=S.z*s,e.force.x=0,e.force.y=0,e.force.z=0,t.x+=e.velocity.x*s,t.y+=e.velocity.y*s,t.z+=e.velocity.z*s}function D(t,e,s){e.isKinematic&&(t.x+=e.velocity.x*s,t.y+=(e.velocity.y+-9.81*s)*s,t.z+=e.velocity.z*s)}const B=n.Az.Create(),E=r.$m.registerSystem({type:"physics",queries:[r.$m.createQuery({inclueComponents:[d]})],update(t){M||(M=new x);const e=t.node;for(let s=0;s<t.queries.length;s++){const r=t.queries[s];for(let s=0;s<r.nodes.length;s++){e.setNode(t.graph,r.nodes[s]);const i=o.getRequired(e).schema;n.Az.Copy(z,i.position),n.Az.Copy(v,i.position),M.setFocalPoint("main",0|z.x,0|z.y,0|z.z);const h=d.getRequired(e).schema,l=a.getRequired(e),c=u.getRequired(e).schema;T.update(l.schema.size.x,l.schema.size.y,l.schema.size.z);const y=T.halfWidth,p=T.halfDepth,m=T.halfHeight;$(z,h,.016),D(z,h,.016);let f=!1,x=!1;for(;;){b.x=z.x-v.x,b.y=z.y-v.y,b.z=z.z-v.z;const t=Math.floor(Math.min(z.x,v.x)-y),e=Math.floor(Math.max(z.x,v.x)+y),s=Math.floor(Math.min(z.y,v.y)-m),r=Math.floor(Math.max(z.y,v.y)+m),i=Math.floor(Math.min(z.z,v.z)-p),o=Math.floor(Math.max(z.z,v.z)+p);_.results.reset();let a=_.results.raw;for(let n=s;n<=r;n++)for(let s=i;s<=o;s++)for(let r=t;r<=e;r++){const t=M.getVoxel(r,n,s);if(B.x=r,B.y=n,B.z=s,!t)continue;t.isRenderable()&&t.getSubstanceData().dve_is_liquid&&(x=!0);const e=t.getCollider();if(!e)continue;const i=g.getCollider(e);if(!i)continue;const o=i.getNodes(B);for(const e of o){w.x=v.x-y,w.y=v.y-m,w.z=v.z-p;const s=P(w,T,e,b);s.hitDepth<1&&1==s.ny&&(f=!0),t.checkCollisions()&&t.getSubstanceData().dve_is_solid&&i.isSolid&&s.hitDepth<a.hitDepth&&_.results.loadIn(e.results)}}if(z.x=v.x+a.hitDepth*b.x+C*a.nx,z.y=v.y+a.hitDepth*b.y+C*a.ny,z.z=v.z+a.hitDepth*b.z+C*a.nz,1==a.hitDepth)break;const h=a.nx*a.nx+a.ny*a.ny+a.nz*a.nz;if(0!=h){n.Az.Copy(v,z);const t=(1-a.hitDepth)*(b.x*a.nx+b.y*a.ny+b.z*a.nz);z.x+=(1-a.hitDepth)*b.x-t/h*a.nx,z.y+=(1-a.hitDepth)*b.y-t/h*a.ny,z.z+=(1-a.hitDepth)*b.z-t/h*a.nz}}n.Az.Copy(i.position,z),c.isGrounded=f?1:0,c.isInLiquid=x?1:0}}}});class N{name;boundingBox;results=new l;position=n.Az.Create();constructor(t,e){this.name=t,this.boundingBox=e}}class I{static createBBox(t=1,e=t,s=t){const r=new c(t,e,s);return r.setPosition(n.Az.Create()),r}nodes=[];addNode(t,e){this.nodes.push(new N(t,e))}hasFlag(t){return void 0!==this.flags[t]}}g.registerCollider(new class extends I{id="dve_cube";isSolid=!0;flags={};constructor(){super(),this.addNode("main",I.createBBox())}getNodes(t){return this.nodes[0].position.x=t.x,this.nodes[0].position.y=t.y,this.nodes[0].position.z=t.z,this.nodes}}),g.registerCollider(new class extends I{id="dve_climable_box";isSolid=!1;flags={dve_climbable:1};constructor(){super(),this.addNode("main",I.createBBox())}getNodes(t){return this.nodes[0].position.x=t.x,this.nodes[0].position.y=t.y,this.nodes[0].position.z=t.z,this.nodes}}),g.registerCollider(new class extends I{id="dve_stair";isSolid=!0;flags={};constructor(){super(),this.addNode("stair-bottom",I.createBBox(1,.5,1)),this.addNode("stair-top",I.createBBox(1,.5,.5))}getNodes(t){return this.nodes[0].position.x=t.x,this.nodes[0].position.y=t.y,this.nodes[0].position.z=t.z,this.nodes[0].position.x=t.x,this.nodes[1].position.y=t.y+.5,this.nodes[0].position.z=t.z,this.nodes}});const j=r.$m.registerContext({type:"dve-dimension",schema:r.$m.schemaFromObject(new class{dimension="main"})});var U;let F;r.$m.registerComponent({type:"dimension-provider",schema:r.$m.schema({dimension:r.$m.property("main")}),init(t){const e=j.get(t.node);e&&t.schema.getCursor().setProxy(t.schema.getSchemaIndex().dimension,e.schema,"dimension")}}),function(t){t.RegisterCollider="register-collider",t.RemoveCollider="remove-collider"}(U||(U={}));let Q=!1;const R=()=>{Q&&(O.graph.update(),F=setTimeout(K,16))},K=()=>R();class O{static graph;static async init(t){const e=r.$m.createGraph();var s;i.set(e.root,null,null,{dve:t}),this.graph=e,(s=t).TC.registerTask(U.RegisterCollider,(t=>[O.graph.addNode(t).index])),s.TC.registerTask(U.RemoveCollider,(([t])=>{O.graph.removeNode(t)}))}static start(){E.set(this.graph),Q=!0,R()}static stop(){E.remove(this.graph),Q=!1,F&&clearTimeout(F)}}},97039:(t,e,s)=>{s.d(e,{Y:()=>c});var r=s(27293),i=s(81168),n=s(39212);i.QK.parent,i.QK.createThread("rich-world"),i.QK.createThread("world");class o extends n.Q{parent=i.QK.parent;world=i.QK.createThread("world");NexusComm=i.QK.createThread("nexus");DataComm=i.QK.createThread("data-loader");ConstructorComm=i.QK.createThreadPool("constructor")}class a{static environment="browser";static instance;TC=i.QK;threads=new o;constructor(t){if(a.instance)return a.instance;a.instance=this}}var h=s(22120),d=s(55138),l=s(75438);async function c(t={}){const e=new a(t||{});a.environment=h.O.isNode()?"node":"browser";let s="render";"node"==a.environment&&(s="server"),await i.QK.init("constructor",self,s);let n=!1;return(0,r.A)({onSync(t){n=!0}}),i.QK.registerTask(d.U.SyncDimension,(t=>{l._.dimensions.add(t.id)})),i.QK.registerTask(d.U.UnSyncDimension,(t=>{})),i.QK.registerTask(d.U.SyncSector,(t=>{l._.sectors.add(t[0][0],t[0][1],t[0][2],t[0][3],t[1])})),i.QK.registerTask(d.U.UnSyncSector,(t=>{l._.sectors.remove(t[0],t[1],t[2],t[3])})),await new Promise((t=>{const e=()=>{if(n)return t(!0);setTimeout(e,10)};e()})),e}},52196:(t,e,s)=>{s.d(e,{w:()=>h});var r=s(62312),i=s(70522),n=s(85212),o=s(80903),a=s(29105);class h{sector;index;static GetBufferSize(){const t=r.k.section.volumne,e=r.k.section.bounds.y;return(0,a.bZ)(2+e/8+e/8+t/8+2*t+2*t+t+2*t+2*t+2*t)}static GetArrayStartIndex(t){return t*h.GetBufferSize()+i.h.GetHeaderSize()}static CreateNew(t,e){const s=r.k.section.volumne,i=r.k.section.bounds.y;let n=this.GetArrayStartIndex(t);const o=new Uint8Array(e,n,2);n+=2;const a=new Uint8Array(e,n,i/8);n+=i/8;const h=new Uint8Array(e,n,i/8);n+=i/8;const d=new Uint8Array(e,n,s/8);n+=s/8;const l=new Uint16Array(e,n,s);n+=2*s;const c=new Uint16Array(e,n,s);n+=2*s;const u=new Uint16Array(e,n,s);n+=2*s;const y=new Uint16Array(e,n,s);n+=2*s;const p=new Uint16Array(e,n,s);n+=2*s;const m=new Uint8Array(e,n,s);return n+=s,{flagArray:o,voxelMap:a,dirtyMap:h,buried:d,ids:l,light:c,level:m,state:u,mod:y,secondary:p}}static toObject(t,e,s){return new h(t,e,s)}position;constructor(t,e,s){this.sector=t,this.index=e,this.position=r.k.section.getPositionFromIndexVec3Array(this.index),this.position[0]=this.position[0]*r.k.section.bounds.x+this.sector.position[0],this.position[1]=this.position[1]*r.k.section.bounds.y+this.sector.position[1],this.position[2]=this.position[2]*r.k.section.bounds.z+this.sector.position[2],this.flagArray=s.flagArray,this.voxelMap=s.voxelMap,this.dirtyMap=s.dirtyMap,this.buried=s.buried,this.ids=s.ids,this.level=s.level,this.light=s.light,this.secondary=s.secondary,this.state=s.state,this.mod=s.mod}getPosition(){return this.position}setBitFlag(t,e){(0,n.JU)(this.flagArray,t,e?1:0)}getBitFlag(t){return 1==(0,n.Tv)(this.flagArray,t)}isDirty(){return this.getBitFlag(o.n.isDirty)}setDirty(t){this.setBitFlag(o.n.isDirty,t),t&&this.sector.setStored(!1)}isInProgress(){return this.getBitFlag(o.n.inProgress)}setInProgress(t){this.setBitFlag(o.n.inProgress,t)}getBuried(t){return 1==(0,n.Tv)(this.buried,t)}setBuried(t,e){return(0,n.JU)(this.buried,t,e?1:0)}setHasVoxel(t,e){return(0,n.JU)(this.voxelMap,t,e?1:0)}getHasVoxel(t){return 1==(0,n.Tv)(this.voxelMap,t)}setHasVoxelDirty(t,e){return(0,n.JU)(this.dirtyMap,t,e?1:0)}getHasVoxelDirty(t){return 1==(0,n.Tv)(this.dirtyMap,t)}getMinMax(){let t=1/0,e=-1/0,s=r.k.section.bounds.y;for(;s--;)(this.getHasVoxel(s)||this.getHasVoxelDirty(s))&&(s<t&&(t=s),s>e&&(e=s));return[t,e]}storeFlags(){const t={};for(const e in o.B.StoredFlags)t[e]=this.getBitFlag(o.B.StoredFlags[e]);return t}loadFlags(t){for(const e in t){const s=o.B.StoredFlags[e];void 0!==s?this.setBitFlag(s,t[e]):console.warn(`${e} does not exist on stored flags for section`)}}toJSON(){return{flagArray:this.flagArray,voxelMap:this.voxelMap,dirtyMap:this.dirtyMap,buried:this.buried,ids:this.ids,light:this.light,level:this.level,secondary:this.secondary,state:this.state,mod:this.mod}}}}},a={};function h(t){var e=a[t];if(void 0!==e)return e.exports;var s=a[t]={exports:{}};return o[t](s,s.exports,h),s.exports}h.m=o,h.x=()=>{var t=h.O(void 0,[147,133],(()=>h(71447)));return h.O(t)},t="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",e="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",s="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",r=t=>{t&&t.d<1&&(t.d=1,t.forEach((t=>t.r--)),t.forEach((t=>t.r--?t.r++:t())))},h.a=(i,n,o)=>{var a;o&&((a=[]).d=-1);var h,d,l,c=new Set,u=i.exports,y=new Promise(((t,e)=>{l=e,d=t}));y[e]=u,y[t]=t=>(a&&t(a),c.forEach(t),y.catch((t=>{}))),i.exports=y,n((i=>{var n;h=(i=>i.map((i=>{if(null!==i&&"object"==typeof i){if(i[t])return i;if(i.then){var n=[];n.d=0,i.then((t=>{o[e]=t,r(n)}),(t=>{o[s]=t,r(n)}));var o={};return o[t]=t=>t(n),o}}var a={};return a[t]=t=>{},a[e]=i,a})))(i);var o=()=>h.map((t=>{if(t[s])throw t[s];return t[e]})),d=new Promise((e=>{(n=()=>e(o)).r=0;var s=t=>t!==a&&!c.has(t)&&(c.add(t),t&&!t.d&&(n.r++,t.push(n)));h.map((e=>e[t](s)))}));return n.r?d:o()}),(t=>(t?l(y[s]=t):d(u),r(a)))),a&&a.d<0&&(a.d=0)},i=[],h.O=(t,e,s,r)=>{if(!e){var n=1/0;for(l=0;l<i.length;l++){for(var[e,s,r]=i[l],o=!0,a=0;a<e.length;a++)(!1&r||n>=r)&&Object.keys(h.O).every((t=>h.O[t](e[a])))?e.splice(a--,1):(o=!1,r<n&&(n=r));if(o){i.splice(l--,1);var d=s();void 0!==d&&(t=d)}}return t}r=r||0;for(var l=i.length;l>0&&i[l-1][2]>r;l--)i[l]=i[l-1];i[l]=[e,s,r]},h.d=(t,e)=>{for(var s in e)h.o(e,s)&&!h.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},h.f={},h.e=t=>Promise.all(Object.keys(h.f).reduce(((e,s)=>(h.f[s](t,e),e)),[])),h.u=t=>t+".bundle.js",h.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),h.p="/",(()=>{var t={541:1};h.f.i=(e,s)=>{t[e]||importScripts(h.p+h.u(e))};var e=self.webpackChunkdivinecraft=self.webpackChunkdivinecraft||[],s=e.push.bind(e);e.push=e=>{var[r,i,n]=e;for(var o in i)h.o(i,o)&&(h.m[o]=i[o]);for(n&&n(h);r.length;)t[r.pop()]=1;s(e)}})(),n=h.x,h.x=()=>Promise.all([h.e(147),h.e(133)]).then(n),h.x()})();