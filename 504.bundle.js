(()=>{"use strict";var e,t,s,r,i,n,o={32054:(e,t,s)=>{s.a(e,(async(e,t)=>{try{var r=s(96894),i=s(51648);const e=await(0,r.Y)();i.h.init(e),i.h.start(),t()}catch(e){t(e)}}),1)},61e3:(e,t,s)=>{s.d(t,{Az:()=>r.Az});var r=s(5919);s(71280)},92149:(e,t,s)=>{s.d(t,{j:()=>o});var r=s(45238),i=s(2341),n=s(98296);class o{name;index;threadPoolName;static readySet=new Set;get isRemoteReady(){return o.readySet.has(this)}get isPortSet(){return Boolean(this.port)}port=null;_pool=null;constructor(e,t,s="worker",r=null){this.name=e,this.index=t,this.threadPoolName=s,this._pool=r}setPort(e){if(this.port=e,"browser"==r.Q.environment){const t=e;t.onmessage=e=>{if(n.E.isInternal(e.data))return n.E.runInternal(e.data,this,e)},t.onmessageerror=e=>{console.error(`Error occured in from thread ${this.name}`),console.log(e.data),console.log(e)}}if("node"==r.Q.environment){const t=e;t.on("message",(e=>{if(n.E.isInternal(e))return n.E.runInternal(e,this,e)})),t.on("error",(e=>{console.error(`Error occured in from thread ${this.name}`),console.log(e)}))}this.sendMessage([n.E.INTERNAL_CODE,i.g.setReady,[this.name,this.index]])}sendMessage(e,t){if(!this.port)throw new Error(`Cannot send message to thread [${this.name}] port is not set`);this.port.postMessage(e,"browser"==r.Q.environment&&t?t:void 0)}connectToThread(e){const t=new MessageChannel;e.sendMessage([n.E.INTERNAL_CODE,i.g.connectPort,[this.name,this.threadPoolName,t.port1]],[t.port1]),this.sendMessage([n.E.INTERNAL_CODE,i.g.connectPort,[e.name,e.threadPoolName,t.port2]],[t.port2])}waitTillTaskExist(e,t=50){let s=!1;return new Promise((r=>{const i=e=>{if(s)return clearTimeout(o);e?(s=!0,r(!0),clearTimeout(o)):setTimeout(n,t)},n=()=>{this.taskExist(e,i)};let o=setTimeout(n,t)}))}taskExist(e,t){const s=n.E.getPromiseId();n.z.checkTasks[2][0]=e,n.z.checkTasks[2][1]=s,this.sendMessage(n.z.checkTasks),n.E.addPromiseTakss("tasks-check",s,(e=>{t(e)}))}runTask(e,t,s,r){const i=r?n.E.getPromiseId():-1;r&&n.E.addPromiseTakss(e,i,r),n.z.runTask[2][0]=e,n.z.runTask[2][1]=i,n.z.runTask[2][2]=t,this.sendMessage(n.z.runTask,s),n.z.runTask[2][2]=null}runTaskAsync(e,t,s){return new Promise((r=>{this.runTask(e,t,s,(e=>{r(e)}))}))}waitTillReady(){return new Promise(((e,t)=>{const s=setInterval((()=>{this.isPortSet&&(clearInterval(s),e(!0))}),1)}))}destroy(){o.readySet.delete(this),this.port&&"terminate"in this.port&&this.port.terminate()}}},5767:(e,t,s)=>{s.d(t,{p:()=>n});var r=s(92149),i=s(45238);class n{name;_totalThreads=0;_currentThread=0;__threads=[];constructor(e){this.name=e}getThreads(){return this.__threads}connectToThread(e){for(const t of this.__threads)t.connectToThread(e)}destroyAll(){for(const e of this.__threads)e.destroy()}isReady(){let e=!0;for(const t of this.__threads)t.isPortSet||(e=!1);return e}waitTillAllAreReady(){return new Promise(((e,t)=>{const s=setInterval((()=>{this.isReady()&&(clearInterval(s),e(!0))}),1)}))}addPort(e){const t=`${this.name}-${this._totalThreads}`,s=new r.j(t,this._totalThreads,this.name,this);i.Q.addThread(s),s.setPort(e),this.__threads.push(s),this._totalThreads++}runTaskForAll(e,t,s){for(let r=0;r<this.__threads.length;r++)this.__threads[r].runTask(e,t,s)}runTask(e,t,s,r,i,n){return"number"!=typeof i?(this._currentThread==n&&this.__handleCount(),this.__threads[this._currentThread].runTask(e,t,s,r),this.__handleCount()):(this.__threads[i].runTask(e,t,s,r),i)}runTaskAsync(e,t,s,r,i){return new Promise((n=>{this.runTask(e,t,s,n,r,i)}))}__handleCount(){let e=this._currentThread;return this._currentThread++,this._currentThread>=this._totalThreads&&(this._currentThread=0),e}}},51648:(e,t,s)=>{s.d(t,{h:()=>Y});var r=s(46392);const i=r.$m.registerContext({type:"dve-nexus"});var n=s(61e3);const o=r.$m.registerComponent({type:"transform",schema:r.$m.schema({position:r.$m.property(n.Az.Create(),{type:"vector-3",binary:"f32"}),rotation:r.$m.property(n.Az.Create(),{type:"vector-3",binary:"f32"}),scale:r.$m.property(n.Az.Create(1,1,1),{type:"vector-3",binary:"f32"})},[{id:"shared-array",type:"typed-array",sharedMemory:!0,arrayType:"f32"},{id:"array",type:"typed-array",arrayType:"f32"}])}),a=r.$m.registerComponent({type:"box-collider",schema:r.$m.schema({offset:r.$m.property(n.Az.Create(),{type:"vector-3",binary:"f32"}),size:r.$m.property(n.Az.Create(),{type:"vector-3",binary:"f32"})},[{id:"shared-binary-object",type:"binary-object",sharedMemory:!0},{id:"shared-binary-object",type:"binary-object"}])});class h{component;constructor(e){this.component=e}setForce(e){return n.Az.Copy(this.component.schema.force,e),e}getForce(){return this.component.schema.force}setVelocity(e){return n.Az.Copy(this.component.schema.velocity,e),e}getVelocity(){return this.component.schema.velocity}}const d=r.$m.registerComponent({type:"physics-body",data:r.$m.data(),schema:r.$m.schema({velocity:r.$m.property(n.Az.Create(),{binary:"f32"}),mass:r.$m.property(1,{binary:"f32"}),friction:r.$m.property(.5,{binary:"f32"}),acceleration:r.$m.property(n.Az.Create(),{binary:"f32"}),angularVelocity:r.$m.property(n.Az.Create(),{binary:"f32"}),angularAcceleration:r.$m.property(n.Az.Create(),{binary:"f32"}),force:r.$m.property(n.Az.Create(),{binary:"f32"}),torque:r.$m.property(n.Az.Create(),{binary:"f32"}),damping:r.$m.property(n.Az.Create(),{binary:"f32"}),angularDamping:r.$m.property(.1,{binary:"f32"}),gravityScale:r.$m.property(1,{binary:"f32"}),isKinematic:r.$m.property(0,{binary:"ui8"})},[{id:"shared-binary-object",type:"binary-object",sharedMemory:!0},{id:"binary-object",type:"binary-object"}]),init:e=>e.data=new h(e.cloneCursor()),dispose:e=>e.data.component.returnCursor()});class c{raw={hitDepth:1,nx:0,ny:0,nz:0};update(e,t,s,r){return this.raw.hitDepth=e,this.raw.nx=t,this.raw.ny=s,this.raw.nz=r,this}loadIn(e){this.raw.hitDepth=e.raw.hitDepth,this.raw.nx=e.raw.nx,this.raw.ny=e.raw.ny,this.raw.nz=e.raw.nz}reset(){this.raw.hitDepth=1,this.raw.nx=0,this.raw.ny=0,this.raw.nz=0}collided(){return this.raw.hitDepth<1}faceHit={top:()=>1==this.raw.ny&&this.collided(),bottom:()=>-1==this.raw.ny&&this.collided(),east:()=>1==this.raw.nx&&this.collided(),west:()=>-1==this.raw.nx&&this.collided(),north:()=>1==this.raw.nz&&this.collided(),south:()=>-1==this.raw.nz&&this.collided()};normalHit={x:()=>this.raw.nx,y:()=>this.raw.ny,z:()=>this.raw.nz}}class l{bounds={minX:1/0,maxX:-1/0,minZ:1/0,maxZ:-1/0,minY:1/0,maxY:-1/0};_full={w:.8,h:1.8,d:.8};_half={w:.4,h:.9,d:.4};position=n.Az.Create();constructor(e=1,t=e,s=e){this._full.w=e,this._full.h=t,this._full.d=s,this._half.w=e/2,this._half.h=t/2,this._half.d=s/2}update(e,t,s){this.width=e,this.height=t,this.depth=s}setPosition(e){n.Az.Copy(this.position,e);const t=this.position;this.bounds.minX=t.x,this.bounds.maxX=t.x+this.width,this.bounds.minZ=t.z,this.bounds.maxZ=t.z+this.depth,this.bounds.minY=t.y,this.bounds.maxY=t.y+this.height}get width(){return this._full.w}get height(){return this._full.h}get depth(){return this._full.d}set width(e){this._full.w=e,this._half.w=e/2}set height(e){this._full.h=e,this._half.h=e/2}set depth(e){this._full.d=e,this._half.d=e/2}get halfWidth(){return this._half.w}get halfHeight(){return this._half.h}get halfDepth(){return this._half.d}pointIsInside(e){return e.x>=this.bounds.minX&&e.x<=this.bounds.maxX&&e.y>=this.bounds.minY&&e.y<=this.bounds.maxY&&e.z>=this.bounds.minZ&&e.z<=this.bounds.maxZ}doesIntersect(e){return this.bounds.minX<=e.bounds.maxX&&this.bounds.maxX>=e.bounds.minX&&this.bounds.minY<=e.bounds.maxY&&this.bounds.maxY>=e.bounds.minY&&this.bounds.minZ<=e.bounds.maxZ&&this.bounds.maxZ>=e.bounds.minZ}*query(){const e=Math.floor(this.bounds.minX),t=Math.floor(this.bounds.minY),s=Math.floor(this.bounds.minZ),r=Math.ceil(this.bounds.maxX),i=Math.ceil(this.bounds.maxY),n=Math.ceil(this.bounds.maxZ);for(let o=t;o<=i;o++)for(let t=e;t<=r;t++)for(let e=s;e<=n;e++)yield[t,o,e]}}const u=r.$m.registerComponent({type:"collider-state",schema:r.$m.schema({isGrounded:r.$m.property(0,{binary:"ui8"}),isInLiquid:r.$m.property(0,{binary:"ui8"})},[{id:"shared-binary-object",type:"binary-object",sharedMemory:!0},{id:"binary-object",type:"binary-object"}])});var y=s(9879),m=s(56059),p=s(40892);let x=[];const f=n.Az.Create();class z extends p.s{sectorCursors=new Map;origin={x:0,y:0,z:0};dimension="";setFocalPoint(e,t,s,r){const i=m.k.sector.getPosition(t,s,r,f);for(const[e,t]of this.sectorCursors)for(const[e,s]of t)x.push(s);this.sectorCursors.clear(),this.dimension=e,this.origin.x=i.x/m.k.sector.bounds.x,this.origin.y=i.y/m.k.sector.bounds.y,this.origin.z=i.z/m.k.sector.bounds.z}inBounds(e,t,s){return m.k.world.inBounds(e,t,s)}getSector(e,t,s){if(!this.inBounds(e,t,s))return null;const r=m.k.sector.getPosition(e,t,s,f),i=r.x/m.k.sector.bounds.x-this.origin.x,n=r.z/m.k.sector.bounds.z-this.origin.z;let o=this.sectorCursors.get(i),a=o?.get(n);if(!a){if(a=x.length?x.shift():new y.j,!a.setSector(this.dimension,r.x,r.y,r.z))return x.push(a),null;o||(o=new Map,this.sectorCursors.set(i,o)),o.set(n,a)}return a}getVoxel(e,t,s){const r=this.getSector(e,t,s);return r?r.getVoxel(e,t,s):null}}const g={colliders:{},registerCollider(e){if(Array.isArray(e))return e.forEach((e=>this.colliders[e.id]=e));this.colliders[e.id]=e},getCollider(e){const t=this.colliders[e];if(!t)throw new Error(`Collider with ${e} does not exists.`);return t}},b=n.Az.Create(),w=n.Az.Create(),v=n.Az.Create(),C=n.Az.Create(),_=.001,T={results:new c,line:new class{start=n.Az.Create();end=n.Az.Create();update(e,t){return n.Az.Copy(this.start,e),n.Az.Copy(this.end,t),this}},plane:new class{dimensions=n.Az.Create();normal=n.Az.Create();update(e,t){return n.Az.Copy(this.dimensions,e),n.Az.Copy(this.normal,t),this}lineToPlane(e){const t=this.normal.x*e.end.x+this.normal.y*e.end.y+this.normal.z*e.end.z;return 0==t?1/0:(this.normal.x*(this.dimensions.x-e.start.x)+this.normal.y*(this.dimensions.y-e.start.y)+this.normal.z*(this.dimensions.z-e.start.z))/t}},dimensions:n.Az.Create()},A=new l,k=(e,t,s)=>e>=t&&e<=s,M={Zero:n.Az.Create(),Up:n.Az.Create(0,1,0),Down:n.Az.Create(0,-1,0),West:n.Az.Create(-1,0,0),East:n.Az.Create(1,0,0),North:n.Az.Create(0,0,1),South:n.Az.Create(0,0,-1)},P=(e,t,s,r)=>{let i,n,o,a,h,d,c;i=s.position.x-(e.x+t.width),n=s.position.y-(e.y+t.height),o=s.position.z-(e.z+t.depth),a=t.width+s.boundingBox.width,h=t.height+s.boundingBox.height,d=t.depth+s.boundingBox.depth,s.results.reset();const l=s.results.raw;return T.line.update(M.Zero,r),T.dimensions.x=i,T.dimensions.y=n,T.dimensions.z=o,c=T.plane.update(T.dimensions,M.West).lineToPlane(T.line),c>=0&&r.x>0&&c<l.hitDepth&&k(c*r.y,n,n+h)&&k(c*r.z,o,o+d)&&s.results.update(c,-1,0,0),T.dimensions.x=i+a,T.dimensions.y=n,T.dimensions.z=o,c=T.plane.update(T.dimensions,M.East).lineToPlane(T.line),c>=0&&r.x<0&&c<l.hitDepth&&k(c*r.y,n,n+h)&&k(c*r.z,o,o+d)&&s.results.update(c,1,0,0),T.dimensions.x=i,T.dimensions.y=n,T.dimensions.z=o,c=T.plane.update(T.dimensions,M.Down).lineToPlane(T.line),c>=0&&r.y>0&&c<l.hitDepth&&k(c*r.x,i,i+a)&&k(c*r.z,o,o+d)&&s.results.update(c,0,-1,0),T.dimensions.x=i,T.dimensions.y=n+h,T.dimensions.z=o,c=T.plane.update(T.dimensions,M.Up).lineToPlane(T.line),c>=0&&r.y<0&&c<l.hitDepth&&k(c*r.x,i,i+a)&&k(c*r.z,o,o+d)&&s.results.update(c,0,1,0),T.dimensions.x=i,T.dimensions.y=n,T.dimensions.z=o,c=T.plane.update(T.dimensions,M.South).lineToPlane(T.line),c>=0&&r.z>0&&c<l.hitDepth&&k(c*r.x,i,i+a)&&k(c*r.y,n,n+h)&&s.results.update(c,0,0,-1),T.dimensions.x=i,T.dimensions.y=n,T.dimensions.z=o+d,c=T.plane.update(T.dimensions,M.South).lineToPlane(T.line),c>=0&&r.z<0&&c<l.hitDepth&&k(c*r.x,i,i+a)&&k(c*r.y,n,n+h)&&s.results.update(c,0,0,1),s.results.raw};let S;n.Az.Create();const $=n.Az.Create();function D(e,t,s){if(t.isKinematic)return;t.force.y+=-9.81*t.mass*t.gravityScale;const r=t.force.x/t.mass,i=t.force.y/t.mass,n=t.force.z/t.mass;t.velocity.x+=r*s,t.velocity.y+=i*s,t.velocity.z+=n*s,t.velocity.y<-50&&(t.velocity.y=-50),t.velocity.x*=1-t.damping.x*s,t.velocity.y*=1-t.damping.y*s,t.velocity.z*=1-t.damping.z*s,$.x=-t.friction*t.velocity.x,$.y=-t.friction*t.velocity.y,$.z=-t.friction*t.velocity.z,t.velocity.x+=$.x*s,t.velocity.y+=$.y*s,t.velocity.z+=$.z*s,t.force.x=0,t.force.y=0,t.force.z=0,e.x+=t.velocity.x*s,e.y+=t.velocity.y*s,e.z+=t.velocity.z*s}function E(e,t,s){t.isKinematic&&(e.x+=t.velocity.x*s,e.y+=(t.velocity.y+-9.81*s)*s,e.z+=t.velocity.z*s)}const N=n.Az.Create(),j=r.$m.registerSystem({type:"physics",queries:[r.$m.createQuery({inclueComponents:[d]})],update(e){S||(S=new z);const t=e.node;for(let s=0;s<e.queries.length;s++){const r=e.queries[s];for(let s=0;s<r.nodes.length;s++){t.setNode(e.graph,r.nodes[s]);const i=o.getRequired(t).schema;n.Az.Copy(b,i.position),n.Az.Copy(C,i.position),S.setFocalPoint("main",0|b.x,0|b.y,0|b.z);const h=d.getRequired(t).schema,c=a.getRequired(t),l=u.getRequired(t).schema;A.update(c.schema.size.x,c.schema.size.y,c.schema.size.z);const y=A.halfWidth,m=A.halfDepth,p=A.halfHeight;D(b,h,.016),E(b,h,.016);let x=!1,f=!1;for(;;){w.x=b.x-C.x,w.y=b.y-C.y,w.z=b.z-C.z;const e=Math.floor(Math.min(b.x,C.x)-y),t=Math.floor(Math.max(b.x,C.x)+y),s=Math.floor(Math.min(b.y,C.y)-p),r=Math.floor(Math.max(b.y,C.y)+p),i=Math.floor(Math.min(b.z,C.z)-m),o=Math.floor(Math.max(b.z,C.z)+m);T.results.reset();let a=T.results.raw;for(let n=s;n<=r;n++)for(let s=i;s<=o;s++)for(let r=e;r<=t;r++){const e=S.getVoxel(r,n,s);if(N.x=r,N.y=n,N.z=s,!e)continue;e.isRenderable()&&e.getSubstanceData().dve_is_liquid&&(f=!0);const t=e.getCollider();if(!t)continue;const i=g.getCollider(t);if(!i)continue;const o=i.getNodes(N);for(const t of o){v.x=C.x-y,v.y=C.y-p,v.z=C.z-m;const s=P(v,A,t,w);s.hitDepth<1&&1==s.ny&&(x=!0),e.checkCollisions()&&e.getSubstanceData().dve_is_solid&&i.isSolid&&s.hitDepth<a.hitDepth&&T.results.loadIn(t.results)}}if(b.x=C.x+a.hitDepth*w.x+_*a.nx,b.y=C.y+a.hitDepth*w.y+_*a.ny,b.z=C.z+a.hitDepth*w.z+_*a.nz,1==a.hitDepth)break;const h=a.nx*a.nx+a.ny*a.ny+a.nz*a.nz;if(0!=h){n.Az.Copy(C,b);const e=(1-a.hitDepth)*(w.x*a.nx+w.y*a.ny+w.z*a.nz);b.x+=(1-a.hitDepth)*w.x-e/h*a.nx,b.y+=(1-a.hitDepth)*w.y-e/h*a.ny,b.z+=(1-a.hitDepth)*w.z-e/h*a.nz}}n.Az.Copy(i.position,b),l.isGrounded=x?1:0,l.isInLiquid=f?1:0}}}});class B{name;boundingBox;results=new c;position=n.Az.Create();constructor(e,t){this.name=e,this.boundingBox=t}}class I{static createBBox(e=1,t=e,s=e){const r=new l(e,t,s);return r.setPosition(n.Az.Create()),r}nodes=[];addNode(e,t){this.nodes.push(new B(e,t))}hasFlag(e){return void 0!==this.flags[e]}}g.registerCollider(new class extends I{id="dve_cube";isSolid=!0;flags={};constructor(){super(),this.addNode("main",I.createBBox())}getNodes(e){return this.nodes[0].position.x=e.x,this.nodes[0].position.y=e.y,this.nodes[0].position.z=e.z,this.nodes}}),g.registerCollider(new class extends I{id="dve_climable_box";isSolid=!1;flags={dve_climbable:1};constructor(){super(),this.addNode("main",I.createBBox())}getNodes(e){return this.nodes[0].position.x=e.x,this.nodes[0].position.y=e.y,this.nodes[0].position.z=e.z,this.nodes}}),g.registerCollider(new class extends I{id="dve_stair";isSolid=!0;flags={};constructor(){super(),this.addNode("stair-bottom",I.createBBox(1,.5,1)),this.addNode("stair-top",I.createBBox(1,.5,.5))}getNodes(e){return this.nodes[0].position.x=e.x,this.nodes[0].position.y=e.y,this.nodes[0].position.z=e.z,this.nodes[0].position.x=e.x,this.nodes[1].position.y=e.y+.5,this.nodes[0].position.z=e.z,this.nodes}});const Q=r.$m.registerContext({type:"dve-dimension",schema:r.$m.schemaFromObject(new class{dimension="main"})});var U;let R;r.$m.registerComponent({type:"dimension-provider",schema:r.$m.schema({dimension:r.$m.property("main")}),init(e){const t=Q.get(e.node);t&&e.schema.getCursor().setProxy(e.schema.getSchemaIndex().dimension,t.schema,"dimension")}}),function(e){e.RegisterCollider="register-collider",e.RemoveCollider="remove-collider"}(U||(U={}));let K=!1;const O=()=>{K&&(Y.graph.update(),R=setTimeout(q,16))},q=()=>O();class Y{static graph;static async init(e){const t=r.$m.createGraph();var s;i.set(t.root,null,null,{dve:e}),this.graph=t,(s=e).TC.registerTask(U.RegisterCollider,(e=>[Y.graph.addNode(e).index])),s.TC.registerTask(U.RemoveCollider,(([e])=>{Y.graph.removeNode(e)}))}static start(){j.set(this.graph),K=!0,O()}static stop(){j.remove(this.graph),K=!1,R&&clearTimeout(R)}}},96894:(e,t,s)=>{s.d(t,{Y:()=>l});var r=s(24042),i=s(62567),n=s(82323);i.QK.parent,i.QK.createThread("rich-world"),i.QK.createThread("world");class o extends n.Q{parent=i.QK.parent;world=i.QK.createThread("world");NexusComm=i.QK.createThread("nexus");DataComm=i.QK.createThread("data-loader");ConstructorComm=i.QK.createThreadPool("constructor")}class a{static environment="browser";static instance;TC=i.QK;threads=new o;constructor(e){if(a.instance)return a.instance;a.instance=this}}var h=s(32005),d=s(78259),c=s(1481);async function l(e={}){const t=new a(e||{});a.environment=h.O.isNode()?"node":"browser";let s="render";"node"==a.environment&&(s="server"),await i.QK.init("constructor",self,s);let n=!1;return(0,r.A)({onSync(e){n=!0}}),i.QK.registerTask(d.U.SyncDimension,(e=>{c._.dimensions.add(e.id)})),i.QK.registerTask(d.U.UnSyncDimension,(e=>{})),i.QK.registerTask(d.U.SyncSector,(e=>{c._.sectors.add(e[0][0],e[0][1],e[0][2],e[0][3],e[1])})),i.QK.registerTask(d.U.UnSyncSector,(e=>{c._.sectors.remove(e[0],e[1],e[2],e[3])})),await new Promise((e=>{const t=()=>{if(n)return e(!0);setTimeout(t,10)};t()})),t}},38903:(e,t,s)=>{s.d(t,{w:()=>a});var r=s(56059),i=s(91669),n=s(20330);const o=[0,0,0];class a{sector;index;static GetBufferSize(){const e=r.k.section.volumne,t=r.k.section.bounds.y;return(s=t/8+t/8+e/8+2*e+2*e+2*e+e+2*e+2*e+2*e)%2==0?s:s+1;var s}static GetArrayStartIndex(e){return e*a.GetBufferSize()+i.h.GetHeaderSize()}static CreateNew(e,t){const s=r.k.section.volumne;let i=this.GetArrayStartIndex(e);const n=r.k.section.bounds.y,o=new Uint8Array(t,i,n/8);i+=n/8;const a=new Uint8Array(t,i,n/8);i+=n/8;const h=new Uint8Array(t,i,s/8);i+=s/8;const d=new Uint16Array(t,i,s);i+=2*s;const c=new Uint16Array(t,i,s);i+=2*s;const l=new Uint16Array(t,i,s);i+=2*s;const u=new Uint16Array(t,i,s);i+=2*s;const y=new Uint16Array(t,i,s);i+=2*s;const m=new Uint8Array(t,i,s);return i+=s,{voxelMap:o,dirtyMap:a,buried:h,ids:d,light:c,level:m,state:l,mod:u,secondary:y}}static toObject(e,t,s){return new a(e,t,s)}constructor(e,t,s){this.sector=e,this.index=t,this.voxelMap=s.voxelMap,this.dirtyMap=s.dirtyMap,this.buried=s.buried,this.ids=s.ids,this.level=s.level,this.light=s.light,this.secondary=s.secondary,this.state=s.state,this.mod=s.mod}getPosition(){return o[0]=this.sector.position[0],o[1]=this.sector.position[1]+this.index*r.k.section.bounds.y,o[2]=this.sector.position[2],o}getBuried(e){return 1==(0,n.Tv)(this.buried,e)}setBuried(e,t){return(0,n.JU)(this.buried,e,t?1:0)}setHasVoxel(e,t){return(0,n.JU)(this.voxelMap,e,t?1:0)}getHasVoxel(e){return 1==(0,n.Tv)(this.voxelMap,e)}setHasVoxelDirty(e,t){return(0,n.JU)(this.dirtyMap,e,t?1:0)}getHasVoxelDirty(e){return 1==(0,n.Tv)(this.dirtyMap,e)}getMinMax(){let e=1/0,t=-1/0,s=r.k.section.bounds.y;for(;s--;)(this.getHasVoxel(s)||this.getHasVoxelDirty(s))&&(s<e&&(e=s),s>t&&(t=s));return[e,t]}toJSON(){return{voxelMap:this.voxelMap,dirtyMap:this.dirtyMap,buried:this.buried,ids:this.ids,light:this.light,level:this.level,secondary:this.secondary,state:this.state,mod:this.mod}}}}},a={};function h(e){var t=a[e];if(void 0!==t)return t.exports;var s=a[e]={exports:{}};return o[e](s,s.exports,h),s.exports}h.m=o,h.x=()=>{var e=h.O(void 0,[738,741],(()=>h(32054)));return h.O(e)},e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",s="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",r=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},h.a=(i,n,o)=>{var a;o&&((a=[]).d=-1);var h,d,c,l=new Set,u=i.exports,y=new Promise(((e,t)=>{c=t,d=e}));y[t]=u,y[e]=e=>(a&&e(a),l.forEach(e),y.catch((e=>{}))),i.exports=y,n((i=>{var n;h=(i=>i.map((i=>{if(null!==i&&"object"==typeof i){if(i[e])return i;if(i.then){var n=[];n.d=0,i.then((e=>{o[t]=e,r(n)}),(e=>{o[s]=e,r(n)}));var o={};return o[e]=e=>e(n),o}}var a={};return a[e]=e=>{},a[t]=i,a})))(i);var o=()=>h.map((e=>{if(e[s])throw e[s];return e[t]})),d=new Promise((t=>{(n=()=>t(o)).r=0;var s=e=>e!==a&&!l.has(e)&&(l.add(e),e&&!e.d&&(n.r++,e.push(n)));h.map((t=>t[e](s)))}));return n.r?d:o()}),(e=>(e?c(y[s]=e):d(u),r(a)))),a&&a.d<0&&(a.d=0)},i=[],h.O=(e,t,s,r)=>{if(!t){var n=1/0;for(c=0;c<i.length;c++){for(var[t,s,r]=i[c],o=!0,a=0;a<t.length;a++)(!1&r||n>=r)&&Object.keys(h.O).every((e=>h.O[e](t[a])))?t.splice(a--,1):(o=!1,r<n&&(n=r));if(o){i.splice(c--,1);var d=s();void 0!==d&&(e=d)}}return e}r=r||0;for(var c=i.length;c>0&&i[c-1][2]>r;c--)i[c]=i[c-1];i[c]=[t,s,r]},h.d=(e,t)=>{for(var s in t)h.o(t,s)&&!h.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},h.f={},h.e=e=>Promise.all(Object.keys(h.f).reduce(((t,s)=>(h.f[s](e,t),t)),[])),h.u=e=>e+".bundle.js",h.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),h.p="/",(()=>{var e={504:1};h.f.i=(t,s)=>{e[t]||importScripts(h.p+h.u(t))};var t=self.webpackChunkdivinecraft=self.webpackChunkdivinecraft||[],s=t.push.bind(t);t.push=t=>{var[r,i,n]=t;for(var o in i)h.o(i,o)&&(h.m[o]=i[o]);for(n&&n(h);r.length;)e[r.pop()]=1;s(t)}})(),n=h.x,h.x=()=>Promise.all([h.e(738),h.e(741)]).then(n),h.x()})();