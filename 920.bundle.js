"use strict";(self.webpackChunkdivinecraft=self.webpackChunkdivinecraft||[]).push([[920],{79104:(t,e,r)=>{r.d(e,{x:()=>a});class a{x;y;static ApplyMatrix(t,e){return{x:t[0]*e.x+t[1]*e.y+t[2],y:t[3]*e.x+t[4]*e.y+t[5]}}static ApplyMatrixArray(t,e){return[t[0]*e[0]+t[1]*e[1]+t[2],t[3]*e[0]+t[4]*e[1]+t[5]]}static RotateAroundPivot(t,e,r){const s={x:e.x-r.x,y:e.y-r.y},i=a.ApplyMatrix(t,s);return{x:i.x+r.x,y:i.y+r.y}}static RotateAroundPivotArray(t,e,r){const s=[e[0]-r[0],e[1]-r[1]],i=a.ApplyMatrixArray(t,s);return[i[0]+r[0],i[1]+r[1]]}static Create(t=0,e=0){return new a(t,e)}static Add(t,e){return{x:t.x+e.x,y:t.y+e.y}}static AddToRef(t,e,r){r.x=t.x+e.x,r.y=t.y+e.y}static AddInPlace(t,e){t.x+=e.x,t.y+=e.y}static AddArray(t,e){return[t[0]+e[0],t[1]+e[1]]}static AddArrayToRef(t,e,r){r[0]=t[0]+e[0],r[1]=t[1]+e[1]}static AddArrayInPlace(t,e){t[0]+=e[0],t[1]+=e[1]}static AddScalar(t,e){return{x:t.x+e,y:t.y+e}}static AddScalarToRef(t,e,r){r.x=t.x+e,r.y=t.y+e}static AddScalarInPlace(t,e){t.x+=e,t.y+=e}static AddScalarArray(t,e){return[t[0]+e,t[1]+e]}static AddScalarArrayToRef(t,e,r){r[0]=t[0]+e,r[1]=t[1]+e}static AddScalarArrayInPlace(t,e){t[0]+=e,t[1]+=e}static Subtract(t,e){return{x:t.x-e.x,y:t.y-e.y}}static SubtractToRef(t,e,r){r.x=t.x-e.x,r.y=t.y-e.y}static SubtractInPlace(t,e){t.x-=e.x,t.y-=e.y}static SubtractArray(t,e){return[t[0]-e[0],t[1]-e[1]]}static SubtractArrayToRef(t,e,r){r[0]=t[0]-e[0],r[1]=t[1]-e[1]}static SubtractArrayInPlace(t,e){t[0]-=e[0],t[1]-=e[1]}static SubtractScalar(t,e){return{x:t.x-e,y:t.y-e}}static SubtractScalarToRef(t,e,r){r.x=t.x-e,r.y=t.y-e}static SubtractScalarInPlace(t,e){t.x-=e,t.y-=e}static SubtractScalarArray(t,e){return[t[0]-e,t[1]-e]}static SubtractScalarArrayToRef(t,e,r){r[0]=t[0]-e,r[1]=t[1]-e}static SubtractScalarArrayInPlace(t,e){t[0]-=e,t[1]-=e}static Multiply(t,e){return{x:t.x*e.x,y:t.y*e.y}}static MultiplyToRef(t,e,r){r.x=t.x*e.x,r.y=t.y*e.y}static MultiplyInPlace(t,e){t.x*=e.x,t.y*=e.y}static MultiplyArray(t,e){return[t[0]*e[0],t[1]*e[1]]}static MultiplyArrayToRef(t,e,r){r[0]=t[0]*e[0],r[1]=t[1]*e[1]}static MultiplyArrayInPlace(t,e){t[0]*=e[0],t[1]*=e[1]}static MultiplyScalar(t,e){return{x:t.x*e,y:t.y*e}}static MultiplyScalarToRef(t,e,r){r.x=t.x*e,r.y=t.y*e}static MultiplyScalarInPlace(t,e){t.x*=e,t.y*=e}static MultiplyScalarArray(t,e){return[t[0]*e,t[1]*e]}static MultiplyScalarArrayToRef(t,e,r){r[0]=t[0]*e,r[1]=t[1]*e}static MultiplyScalarArrayInPlace(t,e){t[0]*=e,t[1]*=e}static Divide(t,e){return{x:t.x/e.x,y:t.y/e.y}}static DivideToRef(t,e,r){r.x=t.x/e.x,r.y=t.y/e.y}static DivideInPlace(t,e){t.x/=e.x,t.y/=e.y}static DivideArray(t,e){return[t[0]/e[0],t[1]/e[1]]}static DivideArrayToRef(t,e,r){r[0]=t[0]/e[0],r[1]=t[1]/e[1]}static DivideArrayInPlace(t,e){t[0]/=e[0],t[1]/=e[1]}static DivideScalar(t,e){return{x:t.x/e,y:t.y/e}}static DivideScalarToRef(t,e,r){r.x=t.x/e,r.y=t.y/e}static DivideScalarInPlace(t,e){t.x/=e,t.y/=e}static DivideScalarArray(t,e){return[t[0]/e,t[1]/e]}static DivideScalarArrayToRef(t,e,r){r[0]=t[0]/e,r[1]=t[1]/e}static DivideScalarArrayInPlace(t,e){t[0]/=e,t[1]/=e}static Dot(t,e){return t.x*e.x+t.y*e.y}static DotArray(t,e){return t[0]*e[0]+t[1]*e[1]}static Length(t){return Math.sqrt(t.x*t.x+t.y*t.y)}static LengthArray(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}static Normalize(t){const e=a.Length(t);return 0===e?{x:0,y:0}:{x:t.x/e,y:t.y/e}}static NormalizeToRef(t,e){const r=a.Length(t);0===r?(e.x=0,e.y=0):(e.x=t.x/r,e.y=t.y/r)}static NormalizeInPlace(t){const e=a.Length(t);0===e?(t.x=0,t.y=0):(t.x/=e,t.y/=e)}static NormalizeArray(t){const e=a.LengthArray(t);return 0===e?[0,0]:[t[0]/e,t[1]/e]}static NormalizeArrayToRef(t,e){const r=a.LengthArray(t);0===r?(e[0]=0,e[1]=0):(e[0]=t[0]/r,e[1]=t[1]/r)}static NormalizeArrayInPlace(t){const e=a.LengthArray(t);0===e?(t[0]=0,t[1]=0):(t[0]/=e,t[1]/=e)}static Distance(t,e){return a.Length(a.Subtract(t,e))}static DistanceArray(t,e){return a.LengthArray(a.SubtractArray(t,e))}static Lerp(t,e,r){return{x:t.x+r*(e.x-t.x),y:t.y+r*(e.y-t.y)}}static LerpToRef(t,e,r,a){a.x=t.x+r*(e.x-t.x),a.y=t.y+r*(e.y-t.y)}static LerpInPlace(t,e,r){t.x+=r*(e.x-t.x),t.y+=r*(e.y-t.y)}static LerpArray(t,e,r){return[t[0]+r*(e[0]-t[0]),t[1]+r*(e[1]-t[1])]}static LerpArrayToRef(t,e,r,a){a[0]=t[0]+r*(e[0]-t[0]),a[1]=t[1]+r*(e[1]-t[1])}static LerpArrayInPlace(t,e,r){t[0]+=r*(e[0]-t[0]),t[1]+=r*(e[1]-t[1])}static Negate(t){return{x:-t.x,y:-t.y}}static NegateToRef(t,e){e.x=-t.x,e.y=-t.y}static NegateInPlace(t){t.x=-t.x,t.y=-t.y}static NegateArray(t){return[-t[0],-t[1]]}static NegateArrayToRef(t,e){e[0]=-t[0],e[1]=-t[1]}static NegateArrayInPlace(t){t[0]=-t[0],t[1]=-t[1]}static Equals(t,e){return t.x===e.x&&t.y===e.y}static EqualsArray(t,e){return t[0]===e[0]&&t[1]===e[1]}static Clone(t){return{x:t.x,y:t.y}}static CloneArray(t){return[t[0],t[1]]}static Copy(t,e){return t.x=e.x,t.y=e.y,t}static CopyArray(t,e){return t[0]=e[0],t[1]=e[1],t}static CopyFromArray(t,e){return t.x=e[0],t.y=e[1],t}static CopyIntoArray(t,e){return t[0]=e.x,t[1]=e.y,t}static ToArray(t){return[t.x,t.y]}static FromArray(t){return new a(t[0],t[1])}constructor(t,e){this.x=t,this.y=e}}},44711:(t,e,r)=>{var a;r.d(e,{m:()=>a}),function(t){t.RunBuildQueue="run-build-queue-for-tasks",t.PlaceVoxel="place-voxel",t.RemoveVoxel="remove-voxel",t.PlaceVoxelArea="place-voxel-area",t.RemoveVoxelArea="remove-voxel-area",t.BuildTemplate="build-template"}(a||(a={}))},75852:(t,e,r)=>{var a;r.d(e,{z:()=>a}),function(t){t[t.BuildSection=0]="BuildSection",t[t.BuildSector=1]="BuildSector",t[t.Generate=2]="Generate",t[t.Decorate=3]="Decorate",t[t.RGBlightUpdate=4]="RGBlightUpdate",t[t.RGBlightRemove=5]="RGBlightRemove",t[t.WorldSun=6]="WorldSun",t[t.SunLightUpdate=7]="SunLightUpdate",t[t.SunLightRemove=8]="SunLightRemove",t[t.Propagation=9]="Propagation",t[t.AnalyzerUpdate=10]="AnalyzerUpdate",t[t.FlowUpdate=11]="FlowUpdate",t[t.FlowRemove=12]="FlowRemove",t[t.ConstructEntity=13]="ConstructEntity",t[t.ConstructItem=14]="ConstructItem",t[t.Explosion=15]="Explosion",t[t.VoxelErease=16]="VoxelErease",t[t.VoxelPaint=17]="VoxelPaint",t[t.VoxelUpdate=18]="VoxelUpdate"}(a||(a={}))},18048:(t,e,r)=>{r.d(e,{l:()=>l});var a=r(35609),s=r(43214),i=r(1481),o=r(13163);const n="dve_air",c=[0,0,0,0,0,0];class l{data={id:n,state:0,secondaryVoxelId:"",level:0,levelState:0,mod:0};dimension="main";x=0;y=0;z=0;name=n;voxelCursor=new s.x;dataCursor=new a.p;setXYZ(t,e,r){return this.x=t,this.y=e,this.z=r,this}newSector(){i._.sectors.new(this.dimension,this.x,this.y,this.z)}setData(t){return this.data.id=t.id?t.id:n,this.data.state=t.state?t.state:0,this.data.secondaryVoxelId=t.secondaryVoxelId?t.secondaryVoxelId:n,this.data.level=t.level?t.level:0,this.data.levelState=t.levelState?t.levelState:0,this.data.mod=t.mod?t.mod:0,this}getData(){return this.data}setRaw(t){return this.voxelCursor.copyRaw(t).process(),this.data.id=this.voxelCursor.getStringId(),this.data.state=this.voxelCursor.getState(),this.data.levelState=this.voxelCursor.getLevelState(),this.data.level=this.voxelCursor.getLevel(),this.voxelCursor.setSecondary(!0),this.voxelCursor.secondaryId>=2&&(this.data.secondaryVoxelId=this.voxelCursor.getStringId()),this.voxelCursor.setSecondary(!1),this.data.mod=this.voxelCursor.getMod(),this}getRaw(){return s.x.VoxelDataToRaw(this.data)}setId(t){return this.data.id=t,this}setName(t){return this.data.id=o.A.voxelName.getId(t),this.name=t,this}setSecondaryId(t){return this.data.secondaryVoxelId=t,this}setShapeState(t){return this.data.state=t,this}setLevel(t){return this.data.level=t,this}setLevelState(t){return this.data.levelState=t,this}setMod(t){return this.data.mod=t,this}clear(){this.data.id="dve_air",this.data.secondaryVoxelId="",this.data.level=0,this.data.levelState=0,this.data.state=0,this.data.mod=0,this.x=0,this.y=0,this.z=0}_debug=!1;_paint(){if(!this.dataCursor.inBounds(this.x,this.y,this.z))return!1;const t=this.dataCursor.getVoxel(this.x,this.y,this.z);if(!t)return;const e=o.A.voxels.getNumberId(this.data.id);if(e<0)return!1;if(t.setId(e),this._debug&&console.warn(this.x,this.y,this.z,this.data.state),t.setState(this.data.state),t.setLevel(this.data.level),t.setMod(this.data.mod),this.data.secondaryVoxelId){const e=o.A.voxels.getNumberId(this.data.secondaryVoxelId);e>0&&(t.setSecondary(!0),t.setId(e),t.setSecondary(!1))}t.process(),t.isLightSource()&&t.getLightSourceValue()&&t.setLight(t.getLightSourceValue()),t.updateVoxel(0)}_erase(){const t=this.dataCursor.getVoxel(this.x,this.y,this.z);t&&t.copyRaw(c).updateVoxel(1)}paint(){return this._paint(),this}erase(){return this._erase(),this}start(t,e,r,a){return this.dataCursor.setFocalPoint(t,e,r,a),this.dimension=t,this.x=e,this.y=r,this.z=a,this}stop(){return this}}},43214:(t,e,r)=>{r.d(e,{x:()=>o});var a=r(27051),s=r(13163),i=r(81847);class o extends a.S{static VoxelDataToRaw(t,e=0){const r=void 0!==t.id&&s.A.voxels.getNumberId(t.id)||0,a=void 0!==t.secondaryVoxelId&&s.A.voxels.getNumberId(t.secondaryVoxelId)||0;let o=0;return void 0!==t.level&&(o=i.o.setLevel(o,t.level)),void 0!==t.levelState&&(o=i.o.setLevelState(o,t.levelState)),[r,e,o,t.state||0,t.mod||0,a]}ids=new Uint16Array(1);light=new Uint16Array(1);level=new Uint8Array(1);state=new Uint16Array(1);mod=new Uint16Array(1);secondary=new Uint16Array(1);loadIn(){}updateVoxel(t){}}},35609:(t,e,r)=>{r.d(e,{p:()=>l});var a=r(61e3),s=r(9879),i=r(56059),o=r(40892);let n=[];const c=a.Az.Create();class l extends o.s{sectorCursors=new Map;origin={x:0,y:0,z:0};dimension="";setFocalPoint(t,e,r,a){const s=i.k.sector.getPosition(e,r,a,c);for(const[t,e]of this.sectorCursors)for(const[t,r]of e)n.push(r);this.sectorCursors.clear(),this.dimension=t,this.origin.x=s.x/i.k.sector.bounds.x,this.origin.y=s.y/i.k.sector.bounds.y,this.origin.z=s.z/i.k.sector.bounds.z}inBounds(t,e,r){return i.k.world.inBounds(t,e,r)}getSector(t,e,r){if(!this.inBounds(t,e,r))return null;const a=i.k.sector.getPosition(t,e,r,c),o=a.x/i.k.sector.bounds.x-this.origin.x,l=a.z/i.k.sector.bounds.z-this.origin.z;let y=this.sectorCursors.get(o),d=y?.get(l);if(!d){if(d=n.length?n.shift():new s.j,!d.setSector(this.dimension,a.x,a.y,a.z))return n.push(d),null;y||(y=new Map,this.sectorCursors.set(o,y)),y.set(l,d)}return d}getVoxel(t,e,r){const a=this.getSector(t,e,r);return a?a.getVoxel(t,e,r):null}}},38903:(t,e,r)=>{r.d(e,{w:()=>n});var a=r(56059),s=r(91669),i=r(20330);const o=[0,0,0];class n{sector;index;static GetBufferSize(){const t=a.k.section.volumne,e=a.k.section.bounds.y;return(r=e/8+e/8+t/8+2*t+2*t+2*t+t+2*t+2*t+2*t)%2==0?r:r+1;var r}static GetArrayStartIndex(t){return t*n.GetBufferSize()+s.h.GetHeaderSize()}static CreateNew(t,e){const r=a.k.section.volumne;let s=this.GetArrayStartIndex(t);const i=a.k.section.bounds.y,o=new Uint8Array(e,s,i/8);s+=i/8;const n=new Uint8Array(e,s,i/8);s+=i/8;const c=new Uint8Array(e,s,r/8);s+=r/8;const l=new Uint16Array(e,s,r);s+=2*r;const y=new Uint16Array(e,s,r);s+=2*r;const d=new Uint16Array(e,s,r);s+=2*r;const u=new Uint16Array(e,s,r);s+=2*r;const x=new Uint16Array(e,s,r);s+=2*r;const h=new Uint8Array(e,s,r);return s+=r,{voxelMap:o,dirtyMap:n,buried:c,ids:l,light:y,level:h,state:d,mod:u,secondary:x}}static toObject(t,e,r){return new n(t,e,r)}constructor(t,e,r){this.sector=t,this.index=e,this.voxelMap=r.voxelMap,this.dirtyMap=r.dirtyMap,this.buried=r.buried,this.ids=r.ids,this.level=r.level,this.light=r.light,this.secondary=r.secondary,this.state=r.state,this.mod=r.mod}getPosition(){return o[0]=this.sector.position[0],o[1]=this.sector.position[1]+this.index*a.k.section.bounds.y,o[2]=this.sector.position[2],o}getBuried(t){return 1==(0,i.Tv)(this.buried,t)}setBuried(t,e){return(0,i.JU)(this.buried,t,e?1:0)}setHasVoxel(t,e){return(0,i.JU)(this.voxelMap,t,e?1:0)}getHasVoxel(t){return 1==(0,i.Tv)(this.voxelMap,t)}setHasVoxelDirty(t,e){return(0,i.JU)(this.dirtyMap,t,e?1:0)}getHasVoxelDirty(t){return 1==(0,i.Tv)(this.dirtyMap,t)}getMinMax(){let t=1/0,e=-1/0,r=a.k.section.bounds.y;for(;r--;)(this.getHasVoxel(r)||this.getHasVoxelDirty(r))&&(r<t&&(t=r),r>e&&(e=r));return[t,e]}toJSON(){return{voxelMap:this.voxelMap,dirtyMap:this.dirtyMap,buried:this.buried,ids:this.ids,light:this.light,level:this.level,secondary:this.secondary,state:this.state,mod:this.mod}}}}}]);